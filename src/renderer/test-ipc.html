<!DOCTYPE html>
<html>
<head>
    <title>IPC Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f5f5f5;
        }
        .test-result { 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 4px;
        }
        .success { 
            background: #d4edda; 
            color: #155724; 
        }
        .error { 
            background: #f8d7da; 
            color: #721c24; 
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <h1>🧪 IPC Communication Test</h1>
    <p>This page tests if IPC communication is working.</p>

    <div id="results"></div>

    <button onclick="testGetVersion()">Test Get Version</button>
    <button onclick="testHandler()">Test Handler</button>
    <button onclick="runAllTests()">Run All Tests</button>

    <script>
        function addResult(message, isSuccess = true) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = 'test-result ' + (isSuccess ? 'success' : 'error');
            div.textContent = (isSuccess ? '✅ ' : '❌ ') + message;
            results.appendChild(div);
            console.log(message);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        async function testGetVersion() {
            try {
                console.log('Testing get-app-version...');
                
                if (!window.electronAPI) {
                    addResult('electronAPI not available', false);
                    return;
                }

                const version = await window.electronAPI.getVersion();
                addResult('Get version successful: ' + version);
                
            } catch (error) {
                addResult('Get version failed: ' + error.message, false);
                console.error('Get version error:', error);
            }
        }

        async function testHandler() {
            try {
                console.log('Testing test-handler...');
                
                if (!window.electronAPI) {
                    addResult('electronAPI not available', false);
                    return;
                }

                const result = await window.electronAPI.testHandler();
                addResult('Test handler successful: ' + result);
                
            } catch (error) {
                addResult('Test handler failed: ' + error.message, false);
                console.error('Test handler error:', error);
            }
        }

        async function runAllTests() {
            clearResults();
            addResult('Starting IPC tests...');
            
            // Check if electronAPI is available
            if (window.electronAPI) {
                addResult('electronAPI is available');
            } else {
                addResult('electronAPI is NOT available', false);
                return;
            }

            await testGetVersion();
            await testHandler();
            
            addResult('All tests completed');
        }

        // Auto-run tests when page loads
        window.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, starting auto tests...');
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>